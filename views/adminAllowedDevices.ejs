<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRMS- Admin Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/images/fevicon_logo.jpeg">
    <link rel="stylesheet" href="/style/dashboard.css">
    <link rel="stylesheet" href="/style/adminAllowedDevices.css">
    <script src="https://kit.fontawesome.com/2d11fdd863.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="dashboard-wrapper flex flex-row">
        <div class="dashboard-right">
            <%- include('components/adminSidebar.ejs') %>
        </div>
        <div class="dashboard-left">
            <%- include('components/header.ejs',{name:"Admin Allowed Devices", link:"Employee"}) %>
                <div class="dashboard-data-container flex flex-row">
                    <div class="admin-allowed-devices-container">
                        <div class="admin-allowed-devices-header">
                            <input type="button" value="Add" class="addButton"/>
                        </div>
                        <table class="admin-allowed-devices-table">
                            <% var i = 1%>
                            <tr class="admin-allowed-devices-table-head-tr">
                                <th>ID</th>
                                <th>IP Adress</th>
                                <th>Device Name</th>
                                <th>Save</th>
                                <th>Delete</th>
                            </tr>
                            <tr class="admin-allowed-devices-table-body-tr tr-1">
                                <td><input type="text" id="ip-id-1" class="ip-id" value="<%= i%>" readonly></td>
                                <td><input type="text" id="ip-address-1"></td>
                                <td><input type="text" id="device-name-1"></td>
                                <td><p onclick="addIpAddress(`<%= i%>`)">Save</p></td>
                                <td><p>Delete</p></td>
                            </tr>
                        </table>
                    </div>
                </div>
        </div>

    </div>
    <script>
        const trID = document.querySelectorAll('.admin-allowed-devices-table-body-tr').values
        let i = trID.length+1
        let trContainer =`
        <tr class="admin-allowed-devices-table-body-tr tr-${i}">
            <td><input type="text" id="new_id-${i}" class="ip-id"></td>
            <td><input type="text" id="new_ip-address-${i}"></td>
            <td><input type="text" id="new_device-name-${i}"></td>
            <td><p>Save</p></td>
            <td><p>Delete</p></td>
        </tr>
       `
       i++;
       async function addIpAddress(i){
            let id = document.querySelector(`#ip-id-${i}`).value
            let ipAddress = document.querySelector(`#ip-address-${i}`).value
            let deviceName = document.querySelector(`#device-name-${i}`).value
            console.log("aaaa",id,ipAddress,deviceName)

        await fetch (`/admin/dashboard/allowed-devices`,{
            method: "POST",
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                ipAddress,
                deviceName
            })
        })
       }

       const addButton = document.querySelector('.addButton')
       const tableContainer = document.querySelector('.admin-allowed-devices-table')
       addButton.addEventListener('click', ()=>{
        tableContainer.innerHTML += trContainer
       })


    </script>
</body>

</html>